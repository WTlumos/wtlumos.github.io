<!DOCTYPE html>
<html lang="zh-CN,en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wtlumos.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":{"gitalk":{"order":-1}}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="MySQL，mysql2，ORM">
<meta property="og:type" content="article">
<meta property="og:title" content="nodejs学习笔记09-MySQL数据库">
<meta property="og:url" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="W.T.的博客">
<meta property="og:description" content="MySQL，mysql2，ORM">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/user.png">
<meta property="og:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/brand.png">
<meta property="og:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/sql-join.png">
<meta property="og:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/left-join.png">
<meta property="og:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/right-join.png">
<meta property="og:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/inner-join.png">
<meta property="og:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/full-join.png">
<meta property="og:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/json.png">
<meta property="og:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/array.png">
<meta property="article:published_time" content="2020-06-05T15:34:41.000Z">
<meta property="article:modified_time" content="2023-04-15T08:18:33.876Z">
<meta property="article:author" content="Wang Ting">
<meta property="article:tag" content="js">
<meta property="article:tag" content="nodejs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/user.png">

<link rel="canonical" href="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>nodejs学习笔记09-MySQL数据库 | W.T.的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">W.T.的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Every day to be a little better</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        
            
  <li class="menu-item menu-item-books">
      
    

    <a href="/books/" rel="section"><i class="fa fa-book fa-fw"></i>书单</a>

  </li>


      
        <li class="menu-item menu-item-route">
      
    

    <a href="/route/" rel="section"><i class="fas fa-route fa-fw"></i>学习路线</a>

  </li>
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-language">

    <a href="/en" rel="section"><i class="fas fa-language fa-fw"></i>English</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/WTlumos" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Wang Ting">
      <meta itemprop="description" content="技术成长笔记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="W.T.的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          nodejs学习笔记09-MySQL数据库
        </h1>

        <div class="post-meta">

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-05 23:34:41" itemprop="dateCreated datePublished" datetime="2020-06-05T23:34:41+08:00">2020-06-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-04-15 16:18:33" itemprop="dateModified" datetime="2023-04-15T16:18:33+08:00">2023-04-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>26k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>24 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote class="blockquote-center">MySQL，mysql2，ORM</blockquote>

<span id="more"></span>

<h1 id="基础认知">1. 基础认知</h1><h2 id="为什么需要数据库">1.1. 为什么需要数据库?</h2><ul>
<li><p>任何的软件系统都需要存放大量的数据，这些数据通常是非常复杂和庞大的:</p>
<ul>
<li>比如用户信息包括姓名、年龄、性别、地址、身份证号、出生日期等等;</li>
<li>比如商品信息包括商品的名称、描述、价格(原价)、分类标签、商品图片等等; </li>
<li>比如歌曲信息包括歌曲的名称、歌手、专辑、歌曲时长、歌词信息、封面图片等等;</li>
</ul>
</li>
<li><p>那么这些信息不能直接存储到文件中吗?可以，但是文件系统有很多的缺点:</p>
</li>
<li><p>很难以合适的方式组织数据(多张表之前的关系合理组织);</p>
</li>
<li><p>并且对数据进行增删改查中的复杂操作(虽然一些简单确实可以)，并且保证单操作的原子性; </p>
</li>
<li><p>很难进行数据共享，比如一个数据库需要为多个程序服务，如何进行很好的数据共享;</p>
</li>
<li><p>需要考虑如何进行数据的高效备份、迁移、恢复;</p>
</li>
<li><p>…</p>
</li>
<li><p>数据库通俗来讲就是一个存储数据的仓库，数据库本质上就是一个软件，一个程序</p>
</li>
</ul>
<h2 id="常见的数据库有哪些">1.2. 常见的数据库有哪些?</h2><ul>
<li><p>通常数据被划分成两类:</p>
<ul>
<li>关系型数据库</li>
<li>非关系型数据库;</li>
</ul>
</li>
<li><p>关系型数据库：MySQL、Oracle、DB2、SQL Server、Postgre SQL等; </p>
<ul>
<li>关系型数据库通常创建很多个二维数据表;</li>
<li>数据表之间相互关联起来，形成一对一、一对多、多对对等关系; </li>
<li>之后可以利用SQL语句在多张表中查询所需的数据;</li>
<li>支持事务，对数据的访问更加的安全;</li>
</ul>
</li>
<li><p>非关系型数据库：MongoDB、Redis、Memcached、HBse等;</p>
<ul>
<li>非关系型数据库的英文其实是Not only SQL，也简称为NoSQL;</li>
<li>相当而已非关系型数据库比较简单一些，存储数据也会更加自由(甚至可以直接将一个复杂的json对象直接塞入到数据库中); </li>
<li>NoSQL是基于Key-Value的对应关系，并且查询的过程中不需要经过SQL解析，所以性能更高;</li>
<li>NoSQL通常不支持事物，需要在自己的程序中来保证一些原子性的操作;</li>
</ul>
</li>
<li><p>如何在开发中选择呢?</p>
<ul>
<li>具体的选择会根据不同的项目进行综合的分析</li>
<li>目前在公司进行后端开发(Node、Java、Go等)，还是以关系型数据库为主;</li>
<li>比较常用的用到非关系型数据库的，在爬取大量的数据进行存储时，会比较常见；</li>
</ul>
</li>
</ul>
<h2 id="认识MySQL">1.3. 认识MySQL</h2><ul>
<li><p>MySQL的介绍:</p>
</li>
<li><p>MySQL原本是一个开源的数据库，原开发者为瑞典的MySQL AB公司; </p>
</li>
<li><p>在2008年被Sun公司收购；</p>
</li>
<li><p>在2009年，Sun被Oracle收购;</p>
</li>
<li><p>所以目前MySQL归属于Oracle;</p>
</li>
<li><p>MySQL是一个关系型数据库，其实本质上就是一款软件、一个程序: </p>
</li>
<li><p>这个程序中管理着多个数据库;</p>
</li>
<li><p>每个数据库中可以有多张表;</p>
</li>
<li><p>每个表中可以由多条数据;</p>
</li>
</ul>
<h2 id="数据组织方式">1.4. 数据组织方式</h2><p><img src="/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/user.png"></p>
<h2 id="下载MySQL软件">1.5. 下载MySQL软件</h2><ul>
<li>下载地址：<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/mysql/">https://dev.mysql.com/downloads/mysql/</a><ul>
<li>根据自己的操作系统下载即可;</li>
<li>推荐直接下载安装版本，在安装过程中会配置一些环境变量; </li>
<li>Windows推荐下载MSI的版本;</li>
<li>Mac推荐下载DMG的版本;</li>
</ul>
</li>
</ul>
<h2 id="终端操作数据库">1.6. 终端操作数据库</h2><h3 id="连接数据库">1.6.1. 连接数据库</h3><ol>
<li><p>方式一:</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u[管理员账号] -p[密码]</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br><span class="line">Enter password: your password</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="显示数据库">1.6.2. 显示数据库</h3><ul>
<li><p>一个数据库软件中，可以包含很多个数据库，如何查看数据库?</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure>

<p>运行语句</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.15 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure>
</li>
<li><p>MySQL默认的数据库</p>
<ul>
<li><code>infomation_schema</code>：信息数据库，其中包括MySQL在维护的其他数据库、表、列、访问权限等信息;</li>
<li><code>performance_schema</code>：性能数据库，记录着MySQL Server数据库引擎在运行过程中的一些资源消耗相关的信息;</li>
<li><code>mysql</code>：用于存储数据库管理者的用户信息、权限信息以及一些日志信息等;</li>
<li><code>sys</code>：相当于是一个简易版的performance_schema，将性能数据库中的数据汇总成更容易理解的形式;</li>
</ul>
</li>
</ul>
<h3 id="创建数据库-表">1.6.3. 创建数据库-表</h3><ul>
<li><p>在终端直接创建一个新的数据库coderhub(一般情况下一个新的项目会对应一个新的数据库)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database coderhub;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用创建的数据库coderhub:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use coderhub;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在数据中，创建一张表:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table user(</span><br><span class="line">    -&gt; name varchar(20),</span><br><span class="line">    -&gt; age int,</span><br><span class="line">    -&gt; height double</span><br><span class="line">    -&gt; &#125;;</span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure>
</li>
<li><p>插入数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;  insert into user (name, age, height) values (<span class="string">&#x27;why&#x27;</span>, 18, 1.88);</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from user;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="GUI工具的介绍">1.7. GUI工具的介绍</h2><ul>
<li>在终端操作数据库有很多不方便的地方:<ul>
<li>语句写出来没有高亮，并且不会有任何的提示;</li>
<li>复杂的语句分成多行，格式看起来并不美观，很容易出现错误; </li>
<li>终端中查看所有的数据库或者表非常的不直观和不方便;</li>
<li>…</li>
</ul>
</li>
<li>所以在开发中，借助于一些GUI工具来连接数据库，之后直接在GUI工具中操作就会非常方便</li>
<li>常见的MySQL的GUI工具有很多：<ul>
<li><code>Navicat</code>：收费;</li>
<li>SQLYog：一款免费的SQL工具;</li>
<li>TablePlus：常用功能都可以使用，但是会多一些限制(比如只能开两个标签页);</li>
</ul>
</li>
</ul>
<h1 id="SQL语句">2. SQL语句</h1><h2 id="认识SQL">2.1. 认识SQL</h2><ul>
<li>操作数据库(特别是在程序中)，就需要有和数据库沟通的语言，这个语言就是SQL<ul>
<li>SQL是Structured Query Language，称之为结构化查询语言，简称SQL;</li>
<li>使用SQL编写出来的语句，就称之为SQL语句;</li>
<li>SQL语句可以用于对数据库进行操作;</li>
</ul>
</li>
<li>事实上，常见的关系型数据库SQL语句都是比较相似的</li>
<li>SQL语句的常用规范<ul>
<li>通常关键字是大写的，比如CREATE、TABLE、SHOW等等; </li>
<li>一条语句结束后，需要以 ; 结尾;</li>
<li>如果遇到关键字作为表明或者字段名称，可以使用&#96;&#96;包裹;</li>
</ul>
</li>
</ul>
<h2 id="SQL语句的分类">2.2. SQL语句的分类</h2><ul>
<li><p>DDL(Data Definition Language)：数据定义语言;</p>
<ul>
<li>可以通过DDL语句对数据库或者表进行：创建、删除、修改等操作;</li>
</ul>
</li>
<li><p>DML(Data Manipulation Language)：数据操作语言;</p>
<ul>
<li>可以通过DML语句对表进行：添加、删除、修改等操作;</li>
</ul>
</li>
<li><p>DQL(Data Query Language)：数据查询语言;</p>
<ul>
<li>可以通过DQL从数据库中查询记录;(重点)</li>
</ul>
</li>
<li><p>DCL(Data Control Language)：数据控制语言;</p>
<ul>
<li>对数据库、表格的权限进行相关访问控制操作;</li>
</ul>
</li>
</ul>
<h2 id="DDL-数据库的操作">2.3. DDL - 数据库的操作</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># 查看所有的数据库</span><br><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line"></span><br><span class="line"># 使用某个数据库</span><br><span class="line">use coderhub;</span><br><span class="line"></span><br><span class="line"># 查看当前正在使用的数据库</span><br><span class="line"><span class="keyword">select</span> database();</span><br><span class="line"></span><br><span class="line"># 创建数据库语句</span><br><span class="line"><span class="keyword">create</span> database test;</span><br><span class="line"></span><br><span class="line"># 更准确的创建数据库</span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> test;</span><br><span class="line"></span><br><span class="line"># 创建数据库 <span class="operator">-</span> 指定字符集，拼音，大小写</span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> test <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8mb4</span><br><span class="line">	<span class="keyword">collate</span> utf8mb4_0900_ai_ci;</span><br><span class="line"></span><br><span class="line"># 修改数据库</span><br><span class="line"><span class="keyword">alter</span> database test <span class="type">character</span> <span class="keyword">set</span> <span class="operator">=</span> utf8 </span><br><span class="line">	<span class="keyword">collate</span> <span class="operator">=</span> utf8_unicode_ci;</span><br><span class="line"></span><br><span class="line"># 删除数据库</span><br><span class="line"><span class="keyword">drop</span> database test;</span><br><span class="line"><span class="keyword">drop</span> database if <span class="keyword">exists</span> test;</span><br></pre></td></tr></table></figure>

<ul>
<li>utf8mb4：可以存储emoji表情</li>
<li>utf8mb4_0900_ai_ci：排序规则<ul>
<li>ai 不区分轻重音</li>
<li>ci 不区分大小写</li>
</ul>
</li>
</ul>
<h2 id="SQL的数据类型">2.4. SQL的数据类型</h2><p>MySQL支持的数据类型有：数字类型，日期和时间类型，字符串(字符和字节)类型，空间类型和 JSON数据类型</p>
<h3 id="数字类型">2.4.1. 数字类型</h3><ul>
<li><p>MySQL的数字类型有很多：</p>
<ul>
<li><p>整数数字类型：<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/integer-types.html">INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT</a>;</p>
<table>
<thead>
<tr>
<th align="left">类型</th>
<th align="left">存储 (字节)</th>
<th align="left">最小值</th>
<th align="left">无符号最小值</th>
<th align="left">最大值</th>
<th align="left">无符号最大值</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>TINYINT</code></td>
<td align="left">1</td>
<td align="left">-128</td>
<td align="left">0</td>
<td align="left">127</td>
<td align="left">255</td>
</tr>
<tr>
<td align="left"><code>SMALLINT</code></td>
<td align="left">2</td>
<td align="left">-32768</td>
<td align="left">0</td>
<td align="left">32767</td>
<td align="left">65535</td>
</tr>
<tr>
<td align="left"><code>MEDIUMINT</code></td>
<td align="left">3</td>
<td align="left">-8388608</td>
<td align="left">0</td>
<td align="left">8388607</td>
<td align="left">16777215</td>
</tr>
<tr>
<td align="left"><code>INT</code></td>
<td align="left">4</td>
<td align="left">-2147483648</td>
<td align="left">0</td>
<td align="left">2147483647</td>
<td align="left">4294967295</td>
</tr>
<tr>
<td align="left"><code>BIGINT</code></td>
<td align="left">8</td>
<td align="left">-$2^{63}$</td>
<td align="left">0</td>
<td align="left">$2^{63}$-1</td>
<td align="left">$2^{64}$-1</td>
</tr>
</tbody></table>
</li>
<li><p>浮点数字类型：<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/floating-point-types.html">FLOAT，DOUBLE</a>（FLOAT是4个字节，DOUBLE是8个字）; </p>
</li>
<li><p>精确数字类型：<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/fixed-point-types.html">DECIMAL，NUMERIC</a>（DECIMAL是NUMERIC的实现形式）;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> `users`(</span><br><span class="line">	`name` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	`age` <span class="type">int</span>,</span><br><span class="line">  <span class="comment">-- 	保留两位小数</span></span><br><span class="line">	`height` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="日期类型">2.4.2. 日期类型</h3><ul>
<li><p><code>YEAR</code>以YYYY格式显示值</p>
<ul>
<li>范围 1901到2155，和 0000。</li>
</ul>
</li>
<li><p><code>DATE</code>类型用于具有日期部分但没有时间部分的值:</p>
<ul>
<li>DATE以格式YYYY-MM-DD显示值 ;</li>
<li>支持的范围是 ‘1000-01-01’ 到 ‘9999-12-31’;</li>
</ul>
</li>
<li><p><code>DATETIME</code>类型用于包含日期和时间部分的值:</p>
<ul>
<li>DATETIME以格式’YYYY-MM-DD hh:mm:ss’显示值;</li>
<li>支持的范围是1000-01-01 00:00:00到9999-12-31 23:59:59;</li>
</ul>
</li>
<li><p><code>TIMESTAMP</code>数据类型被用于同时包含日期和时间部分的值:</p>
<ul>
<li>TIMESTAMP以格式’YYYY-MM-DD hh:mm:ss’显示值;</li>
<li>但是它的范围是UTC的时间范围:’1970-01-01 00:00:01’到’2038-01-19 03:14:07’;</li>
</ul>
</li>
<li><p><code>DATETIME</code> 或 <code>TIMESTAMP</code> 值可以包括在高达微秒(6位)精度的后小数秒一部分</p>
<ul>
<li>比如DATETIME表示的范围可以是’1000-01-01 00:00:00.000000’到’9999-12-31 23:59:59.999999’;</li>
</ul>
</li>
</ul>
<h3 id="字符串类型">2.4.3. 字符串类型</h3><ul>
<li><code>CHAR</code>类型在创建表时为固定长度，长度可以是0到255之间的任何值;</li>
<li>在被查询时，会删除后面的空格;</li>
<li><code>VARCHAR</code>类型的值是可变长度的字符串，长度可以指定为0到65535之间的值;</li>
<li>在被查询时，不会删除后面的空格;</li>
<li><code>BINARY</code> 和 <code>VARBINARY</code> 类型用于存储二进制字符串，存储的是字节字符串;<ul>
<li><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/binary-varbinary.html">https://dev.mysql.com/doc/refman/8.0/en/binary-varbinary.html</a> n</li>
</ul>
</li>
<li><code>BLOB</code> 用于存储大的二进制类型;</li>
<li><code>TEXT</code> 用于存储大的字符串类型;</li>
</ul>
<h2 id="表约束">2.5. 表约束</h2><h3 id="主键-PRIMARY-KEY">2.5.1. 主键:PRIMARY KEY</h3><ul>
<li>一张表中，为了区分每一条记录的唯一性，必须有一个字段是永远不会重复，并且不会为空的，这个字段通常会将它设置为主键:<ul>
<li>主键是表中唯一的索引;</li>
<li>并且必须是NOT NULL的，如果没有设置 NOT NULL，那么MySQL也会隐式的设置为NOT NULL; </li>
<li>主键也可以是多列索引，PRIMARY KEY(key_part, …)，一般称之为联合主键;</li>
<li>建议:开发中主键字段应该是和业务无关的，尽量不要使用业务字段来作为主键;</li>
</ul>
</li>
</ul>
<h3 id="唯一-UNIQUE">2.5.2. 唯一:UNIQUE</h3><ul>
<li>某些字段在开发中是唯一的，不会重复的，比如手机号码、身份证号码等，这个字段可以使用UNIQUE来约束:<ul>
<li>使用UNIQUE约束的字段在表中必须是不同的;</li>
<li>对于所有引擎，UNIQUE 索引允许NULL包含的列具有多个值NULL。</li>
</ul>
</li>
</ul>
<h3 id="不能为空-NOT-NULL">2.5.3. 不能为空:NOT NULL</h3><p>某些字段要求用户必须插入值，不可以为空，这个时候可以使用 NOT NULL 来约束;</p>
<h3 id="默认值-DEFAULT">2.5.4. 默认值:DEFAULT</h3><p>某些字段希望在没有设置值时给予一个默认值，这个时候可以使用 DEFAULT来完成;</p>
<h3 id="自动递增-AUTO-INCREMENT">2.5.5. 自动递增:AUTO_INCREMENT</h3><p>某些字段希望不设置值时可以进行递增，比如用户的id，这个时候可以使用AUTO_INCREMENT来完成;</p>
<h2 id="DML-数据表的操作">2.6. DML-数据表的操作</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> test;</span><br><span class="line">use test;</span><br><span class="line"></span><br><span class="line"># 查看所有的数据表</span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"></span><br><span class="line"># 创建一张表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> users(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	age <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line">	telPhone <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">unique</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">); </span><br><span class="line"></span><br><span class="line"># 查看某个表结构</span><br><span class="line"><span class="keyword">desc</span> users;</span><br><span class="line"></span><br><span class="line"># 删除表</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> users;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> users;</span><br><span class="line"></span><br><span class="line"># 修改表</span><br><span class="line"># 修改表名</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> users rename <span class="keyword">to</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"># 添加列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> publishTime datetime;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> updateTime datetime;</span><br><span class="line"></span><br><span class="line"># 删除列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">drop</span> updateTime;</span><br><span class="line"></span><br><span class="line"># 修改列名</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> change publishTime publishDate datetime;</span><br><span class="line"></span><br><span class="line"># 修改列的数据类型</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> modify publishDate <span class="type">date</span>;</span><br><span class="line"></span><br><span class="line"># 插入数据</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> (name,age,telPhone,publishDate) <span class="keyword">values</span>(<span class="string">&#x27;a&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;12345678901&#x27;</span>,NOW());</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> (name,age,telPhone,publishDate) <span class="keyword">values</span>(<span class="string">&#x27;b&#x27;</span>,<span class="number">19</span>,<span class="string">&#x27;12345678990&#x27;</span>,NOW());</span><br><span class="line"></span><br><span class="line"># 查看表中数据</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"># 更新数据</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;aaaa&#x27;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> name <span class="operator">=</span> <span class="string">&#x27;bbbb&#x27;</span>,age <span class="operator">=</span> <span class="number">18</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"># 删除表中数据</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"># 删除表中所有数据</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"></span><br><span class="line"># 显示最新最新时间</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> updateTime <span class="type">timestamp</span> </span><br><span class="line">	<span class="keyword">default</span> <span class="built_in">current_timestamp</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">current_timestamp</span>;</span><br><span class="line">	</span><br><span class="line"># 显示插入时间</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> modify publishDate datetime </span><br><span class="line">	<span class="keyword">default</span> <span class="built_in">current_timestamp</span>;</span><br><span class="line">	</span><br><span class="line"># 根据一个表结构去创建另外一张表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user1 <span class="keyword">like</span> <span class="keyword">user</span>;	</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> user1;	</span><br><span class="line"><span class="keyword">desc</span> user1;</span><br><span class="line"></span><br><span class="line"># 根据另外一张表的所有内容，创建新的表</span><br><span class="line"># 并不会完整复制表结构</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> user2 (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> user2;	</span><br><span class="line"><span class="keyword">desc</span> user2;</span><br></pre></td></tr></table></figure>



<h2 id="DQL-数据表操作">2.7. DQL-数据表操作</h2><p>SELECT用于从一个或者多个表中检索选中的行(Record)</p>
<p>查询的格式如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> select_expr [, select_expr]... [<span class="keyword">FROM</span> table_references]</span><br><span class="line">          [<span class="keyword">WHERE</span> where_condition]</span><br><span class="line">          [<span class="keyword">ORDER</span> <span class="keyword">BY</span> expr [<span class="keyword">ASC</span> <span class="operator">|</span> <span class="keyword">DESC</span>]]</span><br><span class="line">          [LIMIT &#123;[<span class="keyword">offset</span>,] row_count <span class="operator">|</span> row_count <span class="keyword">OFFSET</span> <span class="keyword">offset</span>&#125;]</span><br><span class="line">          [<span class="keyword">GROUP</span> <span class="keyword">BY</span> expr]</span><br><span class="line">          [<span class="keyword">HAVING</span> where_condition]</span><br></pre></td></tr></table></figure>



<h3 id="基本查询">2.7.1. 基本查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 查询表中所有的字段以及所有的数据</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"># 查询指定的字段</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"># 对字段结果起一个别名</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">as</span> uname <span class="keyword">from</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure>



<h3 id="条件查询">2.7.2. 条件查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">where</span>条件</span><br><span class="line"># 大于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">18</span>;</span><br><span class="line"># 等于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="operator">=</span> <span class="number">18</span>;</span><br><span class="line"># 不等于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="operator">&lt;&gt;</span> <span class="number">18</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="operator">!=</span> <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line"># 逻辑判断语句</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">18</span> <span class="keyword">and</span> age <span class="operator">&lt;</span> <span class="number">30</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">18</span> <span class="operator">&amp;&amp;</span> age <span class="operator">&lt;</span> <span class="number">30</span>;</span><br><span class="line"># 包含 <span class="number">10</span>和<span class="number">30</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="keyword">between</span> <span class="number">10</span> <span class="keyword">and</span> <span class="number">30</span>;</span><br><span class="line"># 查看多个结果中的一个</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> age <span class="keyword">in</span> (<span class="number">18</span>,<span class="number">30</span>);</span><br></pre></td></tr></table></figure>



<h3 id="模糊查询">2.7.3. 模糊查询</h3><ul>
<li>模糊查询使用LIKE关键字，结合两个特殊的符号: <ul>
<li>%表示匹配任意个的任意字符;</li>
<li>_表示匹配一个的任意字符;</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 模糊查询</span><br><span class="line"># 查询所有以c开头的name</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;c%&#x27;</span>;</span><br><span class="line"># 查询所有带a的name</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%a%&#x27;</span>;</span><br><span class="line"># 查询所有以a为第二个字符的name</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;_a%&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="查询结果排序">2.7.4. 查询结果排序</h3><ul>
<li>ORDER BY;</li>
<li>ORDER BY有两个常用的值: <ul>
<li>ASC:升序排列;</li>
<li>DESC:降序排列;</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 排序</span><br><span class="line"># 升序</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> age;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;</span><br><span class="line"># 降序</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>



<h3 id="分页查询">2.7.5. 分页查询</h3><ul>
<li>当数据库中的数据非常多时，一次性查询到所有的结果进行显示是不太现实的: <ul>
<li>在真实开发中，要求传入offset、limit或者page等字段;</li>
<li>它的用法有[LIMIT {[offset,] row_count | row_count OFFSET offset}]</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 分页</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> limit <span class="number">2</span> <span class="keyword">offset</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> limit <span class="number">2</span> <span class="keyword">offset</span> <span class="number">2</span>;</span><br><span class="line"># <span class="keyword">offset</span>, row_count</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> limit <span class="number">4</span>,<span class="number">3</span>;</span><br></pre></td></tr></table></figure>



<h3 id="聚合函数">2.7.6. 聚合函数</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html">聚合函数</a>表示对值集合进行操作的组(集合)函数</p>
<table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_avg"><code>AVG()</code></a></td>
<td align="left">Return the average value of the argument</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_bit-and"><code>BIT_AND()</code></a></td>
<td align="left">Return bitwise AND</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_bit-or"><code>BIT_OR()</code></a></td>
<td align="left">Return bitwise OR</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_bit-xor"><code>BIT_XOR()</code></a></td>
<td align="left">Return bitwise XOR</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_count"><code>COUNT()</code></a></td>
<td align="left">Return a count of the number of rows returned</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_count-distinct"><code>COUNT(DISTINCT)</code></a></td>
<td align="left">Return the count of a number of different values</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_group-concat"><code>GROUP_CONCAT()</code></a></td>
<td align="left">Return a concatenated string</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_json-arrayagg"><code>JSON_ARRAYAGG()</code></a></td>
<td align="left">Return result set as a single JSON array</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_json-objectagg"><code>JSON_OBJECTAGG()</code></a></td>
<td align="left">Return result set as a single JSON object</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_max"><code>MAX()</code></a></td>
<td align="left">Return the maximum value</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_min"><code>MIN()</code></a></td>
<td align="left">Return the minimum value</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_std"><code>STD()</code></a></td>
<td align="left">Return the population standard deviation</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_stddev"><code>STDDEV()</code></a></td>
<td align="left">Return the population standard deviation</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_stddev-pop"><code>STDDEV_POP()</code></a></td>
<td align="left">Return the population standard deviation</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_stddev-samp"><code>STDDEV_SAMP()</code></a></td>
<td align="left">Return the sample standard deviation</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_sum"><code>SUM()</code></a></td>
<td align="left">Return the sum</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_var-pop"><code>VAR_POP()</code></a></td>
<td align="left">Return the population standard variance</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_var-samp"><code>VAR_SAMP()</code></a></td>
<td align="left">Return the sample variance</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_variance"><code>VARIANCE()</code></a></td>
<td align="left">Return the population standard variance</td>
</tr>
</tbody></table>
<p>应用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 计算所有条目的数量</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"># 计算年龄和</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(age) <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"># 最大和最小年龄</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(age) <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(age) <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line"># 年龄平均值</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(age) <span class="keyword">from</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure>



<h3 id="Group-By">2.7.7. Group By</h3><ul>
<li><p>事实上聚合函数相当于默认将所有的数据分成了一组:</p>
<ul>
<li>使用avg还是max等，都是将所有的结果看成一组来计算的;</li>
<li>那么如果希望划分多个组：比如相似名字的平均年龄值，应该怎么来做呢? </li>
<li>使用 GROUP BY;</li>
</ul>
</li>
<li><p>GROUP BY通常和聚合函数一起使用</p>
</li>
<li><p>表示先对数据进行分组，再对每一组数据，进行聚合函数的计算;</p>
</li>
<li><p>给Group By查询到的结果添加一些约束，可以使用：HAVING</p>
</li>
<li><p>实现需求: </p>
<ul>
<li>根据班级进行分组;</li>
<li>计算各个品牌中：人员个数、最大年龄、最小年龄、平均年龄;</li>
<li>筛选条件为平均年龄在24以上;</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 添加班级列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> <span class="keyword">add</span> classNum <span class="type">int</span>;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> classNum <span class="operator">=</span> <span class="number">1</span> <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%a%&#x27;</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">user</span> modify classNum <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">select</span> classNum,</span><br><span class="line">	<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> count,</span><br><span class="line">	round(<span class="built_in">avg</span>(age),<span class="number">2</span>) <span class="keyword">as</span> avgAge,</span><br><span class="line">	<span class="built_in">max</span>(age) <span class="keyword">as</span> maxAge,</span><br><span class="line">	<span class="built_in">min</span>(age) <span class="keyword">as</span> minAge</span><br><span class="line"><span class="keyword">from</span> <span class="keyword">user</span> </span><br><span class="line">		<span class="keyword">group</span> <span class="keyword">by</span> classNum</span><br><span class="line">		<span class="keyword">having</span> avgAge <span class="operator">&gt;</span> <span class="number">24</span>;</span><br></pre></td></tr></table></figure>



<h2 id="创建多张表">2.8. 创建多张表</h2><h3 id="建表">2.8.1. 建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> brand( </span><br><span class="line">		id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment, </span><br><span class="line">		name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">		website <span class="type">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    worldRank <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"> # 插入数据</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> brand (name,website,worldRank) <span class="keyword">values</span> (<span class="string">&#x27;华为&#x27;</span>,<span class="string">&#x27;www.huawei.com&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> brand (name,website,worldRank) <span class="keyword">values</span> (<span class="string">&#x27;小米&#x27;</span>,<span class="string">&#x27;www.mi.com&#x27;</span>,<span class="number">10</span>);</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> brand (name,website,worldRank) <span class="keyword">values</span> (<span class="string">&#x27;苹果&#x27;</span>,<span class="string">&#x27;www.apple.com&#x27;</span>,<span class="number">5</span>);</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> brand (name,website,worldRank) <span class="keyword">values</span> (<span class="string">&#x27;OPPO&#x27;</span>,<span class="string">&#x27;www.huawei.com&#x27;</span>,<span class="number">15</span>);</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> brand (name,website,worldRank) <span class="keyword">values</span> (<span class="string">&#x27;京东&#x27;</span>,<span class="string">&#x27;www.jd.com&#x27;</span>,<span class="number">3</span>);</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> brand (name,website,worldRank) <span class="keyword">values</span> (<span class="string">&#x27;Google&#x27;</span>,<span class="string">&#x27;www.google.com&#x27;</span>,<span class="number">8</span>);</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> brand;</span><br></pre></td></tr></table></figure>



<h3 id="创建外键">2.8.2. 创建外键</h3><ul>
<li><p>将两张表联系起来，将 products中的brand_id关联到brand中的id: </p>
<ul>
<li><p>如果是创建表添加外键约束，我们需要在创建表的()最后添加如下语句;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreign</span> key (brand_id) <span class="keyword">references</span> brand(id)</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果是表已经创建好，额外添加外键:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> products <span class="keyword">add</span> <span class="keyword">foreign</span> key(brand_id) <span class="keyword">references</span> brand(id);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>创建语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> products(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">	brand <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">	brand_id <span class="type">int</span>,</span><br><span class="line">	<span class="keyword">foreign</span> key (brand_id) <span class="keyword">references</span> brand(id)</span><br><span class="line"> )</span><br><span class="line"> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> products (brand,brand_id) <span class="keyword">values</span> (<span class="string">&#x27;华为&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> products (brand,brand_id) <span class="keyword">values</span> (<span class="string">&#x27;荣耀&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> products (brand,brand_id) <span class="keyword">values</span> (<span class="string">&#x27;OPPO&#x27;</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> products (brand,brand_id) <span class="keyword">values</span> (<span class="string">&#x27;iphone13&#x27;</span>,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products;</span><br></pre></td></tr></table></figure>



<h3 id="外键存在时更新和删除数据">2.8.3. 外键存在时更新和删除数据</h3><ul>
<li><p>思考一个问题:</p>
<ul>
<li>如果products中引用的外键被更新了或者删除了，这个时候会出现什么情况呢?</li>
</ul>
</li>
<li><p>进行更新操作:</p>
<ul>
<li>比如将华为的id更新为100</li>
</ul>
</li>
<li><p>这个时候执行代码是报错的:</p>
<p><img src="/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/brand.png"></p>
</li>
</ul>
<h3 id="如何进行更新呢">2.8.4. 如何进行更新呢?</h3><ul>
<li>修改on delete或者on update的值; </li>
<li>给更新或者删除时设置几个值:<ul>
<li><code>RESTRICT</code>(默认属性)：当更新或删除某个记录时，会检查该记录是否有关联的外键记录，有的话会报错的， 不允许更新或删除;</li>
<li><code>NO ACTION</code>：和RESTRICT是一致的，是在SQL标准中定义的;</li>
<li><code>CASCADE</code>：当更新或删除某个记录时，会检查该记录是否有关联的外键记录，有的话:<ul>
<li>更新：那么会更新对应的记录;</li>
<li>删除：那么关联的记录会被一起删除掉;</li>
</ul>
</li>
<li><code>SET NULL</code>：当更新或删除某个记录时，会检查该记录是否有关联的外键记录，有的话，将对应的值设置为 NULL;</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> products <span class="keyword">add</span> <span class="keyword">foreign</span> key(brand_id) <span class="keyword">references</span> brand(id) </span><br><span class="line">																							 <span class="keyword">on</span> <span class="keyword">update</span> cascade</span><br><span class="line">																							 <span class="keyword">on</span> <span class="keyword">delete</span> restrict;</span><br><span class="line"><span class="keyword">update</span> brand <span class="keyword">set</span> id <span class="operator">=</span> <span class="number">100</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products;</span><br><span class="line"></span><br><span class="line"># 无法删除</span><br><span class="line"><span class="comment">-- delete from brand where id = 3;</span></span><br></pre></td></tr></table></figure>



<h3 id="多表查询">2.8.5. 多表查询</h3><ul>
<li><p>如果查询到产品的同时，显示对应的品牌相关的信息，因为数据是存放在两张表中，所以这个时候就需要进行多表查询</p>
</li>
<li><p>如果直接通过查询语句希望在多张表中查询到数据，这个时候是什么效果呢?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products, brand;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>一共有 20 条数据，这个数据量是如何得到的呢?</p>
<ul>
<li>第一张表的 4 条 * 第二张表的 5 条数据;</li>
<li>也就是说第一张表中每一个条数据，都会和第二张表中的每一条数据结合一次; </li>
<li>这个结果称之为 <code>笛卡尔乘积</code>，也称之为直积，表示为 <code>X*Y</code>;</li>
</ul>
</li>
</ul>
</li>
<li><p>但是事实上很多的数据是没有意义的，比如华为和苹果、小米的品牌结合起来的数据就是没有意义的，可不可以进行筛选呢?</p>
<ul>
<li><p>使用where来进行筛选;</p>
</li>
<li><p>这个表示查询到笛卡尔乘积后的结果中，符合 <code>products.brand_id = brand.id</code> 条件的数据过滤出来;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products,brand </span><br><span class="line">	<span class="keyword">where</span> products.brand_id <span class="operator">=</span> brand.id;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>事实上想要的效果并不是这样的，而且表中的某些特定的数据，这个时候可以使用 SQL JOIN 操作: </p>
<ul>
<li>左连接</li>
<li>右连接 </li>
<li>内连接 </li>
<li>全连接</li>
</ul>
</li>
</ul>
<p><img src="/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/sql-join.png"></p>
<h3 id="左连接">2.8.6. 左连接</h3><ul>
<li><p>如果希望获取到的是左边所有的数据(以左表为主):</p>
<ul>
<li><p>这个时候就表示无论左边的表是否有对应的brand_id的值对应右边表的id，左边的数据都会被查询出来; </p>
</li>
<li><p>这个也是开发中使用最多的情况，它的完整写法是LEFT [OUTER] JOIN，但是OUTER可以省略的;</p>
<p><img src="/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/left-join.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 左连接</span><br><span class="line"># 查询所有的手机（包括没有品牌信息的手机）以及对应的品牌<span class="keyword">null</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products</span><br><span class="line">	<span class="keyword">left</span> <span class="keyword">join</span> brand</span><br><span class="line">	<span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id;</span><br><span class="line"></span><br><span class="line"># 查询没有对应品牌数据的手机</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products</span><br><span class="line">	<span class="keyword">left</span> <span class="keyword">join</span> brand</span><br><span class="line">	<span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id</span><br><span class="line">	<span class="keyword">where</span> brand.id <span class="keyword">is</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="右连接">2.8.7. 右连接</h3><ul>
<li><p>如果希望获取到的是右边所有的数据(以由表为主):</p>
<ul>
<li><p>这个时候就表示无论左边的表中的brand_id是否有和右边表中的id对应，右边的数据都会被查询出来; </p>
</li>
<li><p>右连接在开发中没有左连接常用，它的完整写法是RIGHT [OUTER] JOIN，但是OUTER可以省略的;</p>
<p><img src="/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/right-join.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 右连接</span><br><span class="line"># 查询所有的品牌（包括没有手机信息的品牌）以及对应的手机<span class="keyword">null</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products</span><br><span class="line">	<span class="keyword">right</span> <span class="keyword">join</span> brand</span><br><span class="line">	<span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id;</span><br><span class="line"></span><br><span class="line"># 查询没有对应手机数据的品牌</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products</span><br><span class="line">	<span class="keyword">right</span> <span class="keyword">join</span> brand</span><br><span class="line">	<span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id</span><br><span class="line">	<span class="keyword">where</span> products.brand_id <span class="keyword">is</span> <span class="keyword">null</span>;	</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="内连接">2.8.8. 内连接</h3><ul>
<li><p>事实上内连接是表示左边的表和右边的表都有对应的数据关联: </p>
</li>
<li><p>内连接在开发中偶尔也会常见使用;</p>
</li>
<li><p>内连接有其他的写法：CROSS JOIN或者 JOIN都可以;</p>
<p><img src="/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/inner-join.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products</span><br><span class="line">	<span class="keyword">inner</span> <span class="keyword">join</span> brand</span><br><span class="line">	<span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id;</span><br></pre></td></tr></table></figure>
</li>
<li><p>它和之前的下面写法是一样的效果:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products,brand <span class="keyword">where</span> products.brand_id <span class="operator">=</span> brand.id;</span><br></pre></td></tr></table></figure>
</li>
<li><p>但是他们代表的含义并不相同:</p>
<ul>
<li>SQL语句一：内连接，代表的是在两张表连接时就会约束数据之间的关系，来决定之后查询的结果;</li>
<li>SQL语句二：where条件，代表的是先计算出笛卡尔乘积，在笛卡尔乘积的数据基础之上进行where条件的筛选;</li>
</ul>
</li>
</ul>
<h3 id="全连接">2.8.9. 全连接</h3><p>SQL规范中全连接是使用FULL JOIN，但是MySQL中并没有对它的支持，我们需要使用 UNION 来实现:</p>
<p><img src="/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/full-join.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products <span class="keyword">left</span> <span class="keyword">join</span> brand <span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id)</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products <span class="keyword">right</span> <span class="keyword">join</span> brand <span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products <span class="keyword">left</span> <span class="keyword">join</span> brand <span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id <span class="keyword">where</span> brand.id <span class="keyword">is</span> <span class="keyword">null</span>)</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> products <span class="keyword">right</span> <span class="keyword">join</span> brand <span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id <span class="keyword">where</span> products.brand_id <span class="keyword">is</span> <span class="keyword">null</span>)</span><br></pre></td></tr></table></figure>



<h2 id="多对多关系数据">2.9. 多对多关系数据</h2><ul>
<li>在开发中遇到多对多的关系:<ul>
<li>比如学生可以选择多门课程，一个课程可以被多个学生选择; </li>
<li>这种情况应该在开发中如何处理呢?</li>
</ul>
</li>
</ul>
<h3 id="建立两张表">2.9.1. 建立两张表</h3>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> # 创建学生表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `students`(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT, </span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	age <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"># 创建课程表</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `courses`(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT, </span><br><span class="line">	name <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	price <span class="keyword">DOUBLE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students` (name, age) <span class="keyword">VALUES</span>(<span class="string">&#x27;why&#x27;</span>, <span class="number">18</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students` (name, age) <span class="keyword">VALUES</span>(<span class="string">&#x27;tom&#x27;</span>, <span class="number">22</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students` (name, age) <span class="keyword">VALUES</span>(<span class="string">&#x27;lilei&#x27;</span>, <span class="number">25</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students` (name, age) <span class="keyword">VALUES</span>(<span class="string">&#x27;lucy&#x27;</span>, <span class="number">16</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students` (name, age) <span class="keyword">VALUES</span>(<span class="string">&#x27;lily&#x27;</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` (name, price) <span class="keyword">VALUES</span> (<span class="string">&#x27;英语&#x27;</span>, <span class="number">100</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` (name, price) <span class="keyword">VALUES</span> (<span class="string">&#x27;语文&#x27;</span>, <span class="number">666</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` (name, price) <span class="keyword">VALUES</span> (<span class="string">&#x27;数学&#x27;</span>, <span class="number">888</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` (name, price) <span class="keyword">VALUES</span> (<span class="string">&#x27;历史&#x27;</span>, <span class="number">80</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` (name, price) <span class="keyword">VALUES</span> (<span class="string">&#x27;科学&#x27;</span>, <span class="number">999</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `courses` (name, price) <span class="keyword">VALUES</span> (<span class="string">&#x27;美术&#x27;</span>, <span class="number">100</span>);</span><br></pre></td></tr></table></figure>



<h3 id="创建关系表">2.9.2. 创建关系表</h3>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 关系表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> `students_select_courses`(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">	student_id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	course_id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	<span class="keyword">foreign</span> key(student_id) <span class="keyword">references</span> students(id) <span class="keyword">on</span> <span class="keyword">update</span> cascade,</span><br><span class="line">	<span class="keyword">foreign</span> key(course_id) <span class="keyword">references</span> courses(id) <span class="keyword">on</span> <span class="keyword">update</span> cascade</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"> # why 选修了 英文和数学</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students_select_courses` (student_id, course_id) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students_select_courses` (student_id, course_id) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"># lilei选修了 语文和数学和历史</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students_select_courses` (student_id, course_id) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="number">2</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students_select_courses` (student_id, course_id) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="number">3</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `students_select_courses` (student_id, course_id) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure>



<h3 id="查询多对多数据">2.9.3. 查询多对多数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"># 查询所有的学生选择的所有课程</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	stu.id studentId,stu.name studentName,cs.id courseId,cs.name courseName,cs.price coursePrice</span><br><span class="line"><span class="keyword">from</span> students stu	</span><br><span class="line"><span class="keyword">join</span> students_select_courses ssc </span><br><span class="line">	<span class="keyword">on</span> stu.id <span class="operator">=</span> ssc.student_id</span><br><span class="line"><span class="keyword">join</span> courses cs </span><br><span class="line">	<span class="keyword">on</span> ssc.course_id <span class="operator">=</span> cs.id;</span><br><span class="line"></span><br><span class="line"># 查询所有的学生选课情况</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	stu.id studentId,stu.name studentName,cs.id courseId,cs.name courseName,cs.price coursePrice</span><br><span class="line"><span class="keyword">from</span> students stu	</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> students_select_courses ssc </span><br><span class="line">	<span class="keyword">on</span> stu.id <span class="operator">=</span> ssc.student_id</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> courses cs </span><br><span class="line">	<span class="keyword">on</span> ssc.course_id <span class="operator">=</span> cs.id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># why同学选择了哪些课程</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	stu.id studentId,stu.name studentName,cs.id courseId,cs.name courseName,cs.price coursePrice</span><br><span class="line"><span class="keyword">from</span> students stu	</span><br><span class="line"><span class="keyword">join</span> students_select_courses ssc </span><br><span class="line">	<span class="keyword">on</span> stu.id <span class="operator">=</span> ssc.student_id</span><br><span class="line"><span class="keyword">join</span> courses cs </span><br><span class="line">	<span class="keyword">on</span> ssc.course_id <span class="operator">=</span> cs.id</span><br><span class="line">	<span class="keyword">where</span> stu.name <span class="operator">=</span> <span class="string">&#x27;why&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># lily同学选择了哪些课程(注意，这里必须用左连接，事实上上面也应该使用的是左连接)</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	stu.id studentId,stu.name studentName,cs.id courseId,cs.name courseName,cs.price coursePrice</span><br><span class="line"><span class="keyword">from</span> students stu	</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> students_select_courses ssc </span><br><span class="line">	<span class="keyword">on</span> stu.id <span class="operator">=</span> ssc.student_id</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> courses cs </span><br><span class="line">	<span class="keyword">on</span> ssc.course_id <span class="operator">=</span> cs.id</span><br><span class="line">	<span class="keyword">where</span> stu.name <span class="operator">=</span> <span class="string">&#x27;lily&#x27;</span>;</span><br><span class="line">	</span><br><span class="line"># 哪些学生是没有选课的</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	stu.id studentId,stu.name studentName,cs.id courseId,cs.name courseName,cs.price coursePrice</span><br><span class="line"><span class="keyword">from</span> students stu	</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> students_select_courses ssc </span><br><span class="line">	<span class="keyword">on</span> stu.id <span class="operator">=</span> ssc.student_id</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> courses cs </span><br><span class="line">	<span class="keyword">on</span> ssc.course_id <span class="operator">=</span> cs.id</span><br><span class="line">	<span class="keyword">where</span> cs.id <span class="keyword">is</span> <span class="keyword">null</span>;	</span><br><span class="line">	</span><br><span class="line"># 查询哪些课程没有被学生选择</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	stu.id studentId,stu.name studentName,cs.id courseId,cs.name courseName,cs.price coursePrice</span><br><span class="line"><span class="keyword">from</span> students stu	</span><br><span class="line"><span class="keyword">right</span> <span class="keyword">join</span> students_select_courses ssc </span><br><span class="line">	<span class="keyword">on</span> stu.id <span class="operator">=</span> ssc.student_id</span><br><span class="line"><span class="keyword">right</span> <span class="keyword">join</span> courses cs </span><br><span class="line">	<span class="keyword">on</span> ssc.course_id <span class="operator">=</span> cs.id</span><br><span class="line">	<span class="keyword">where</span> stu.id <span class="keyword">is</span> <span class="keyword">null</span>;	</span><br></pre></td></tr></table></figure>



<h2 id="将联合查询到的数据转成对象">2.10. 将联合查询到的数据转成对象</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 将联合查询到的数据转成对象</span><br><span class="line"># 商品 一对多</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	products.id <span class="keyword">as</span> pid, products.brand <span class="keyword">as</span> pBrand,</span><br><span class="line">	<span class="built_in">json_object</span>(<span class="string">&#x27;id&#x27;</span>,brand.id,<span class="string">&#x27;name&#x27;</span>,brand.name,<span class="string">&#x27;rank&#x27;</span>,brand.worldRank,<span class="string">&#x27;website&#x27;</span>,brand.website) <span class="keyword">as</span> brand</span><br><span class="line"><span class="keyword">from</span> products <span class="keyword">left</span> <span class="keyword">join</span> brand <span class="keyword">on</span> products.brand_id <span class="operator">=</span> brand.id;</span><br><span class="line"></span><br><span class="line"># 学生选课 多对多</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	stu.id <span class="keyword">as</span> studentId, stu.name <span class="keyword">as</span> studentName,</span><br><span class="line">	<span class="built_in">json_object</span>(<span class="string">&#x27;id&#x27;</span>,cs.id,<span class="string">&#x27;name&#x27;</span>,cs.name) <span class="keyword">as</span> courses</span><br><span class="line"><span class="keyword">from</span> students stu </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> students_select_courses ssc </span><br><span class="line">	<span class="keyword">on</span> stu.id <span class="operator">=</span> ssc.student_id</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> courses cs </span><br><span class="line">	<span class="keyword">on</span> ssc.course_id <span class="operator">=</span> cs.id;</span><br></pre></td></tr></table></figure>

<p><img src="/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/json.png"></p>
<h2 id="将联合查询到的数据转成数组">2.11. 将联合查询到的数据转成数组</h2><ul>
<li>在多对多关系中，希望查询到的是一个数组:<ul>
<li>比如一个学生的多门课程信息，应该是放到一个数组中的;</li>
<li>数组中存放的是课程信息的一个个对象;</li>
<li>这个时候要 JSON_ARRAYAGG和JSON_OBJECT结合来使用;</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">	stu.id <span class="keyword">as</span> studentId, stu.name <span class="keyword">as</span> studentName,</span><br><span class="line">	<span class="built_in">json_arrayagg</span>(<span class="built_in">json_object</span>(<span class="string">&#x27;id&#x27;</span>,cs.id,<span class="string">&#x27;name&#x27;</span>,cs.name)) <span class="keyword">as</span> courses</span><br><span class="line"><span class="keyword">from</span> students stu </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> students_select_courses ssc </span><br><span class="line">	<span class="keyword">on</span> stu.id <span class="operator">=</span> ssc.student_id</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> courses cs </span><br><span class="line">	<span class="keyword">on</span> ssc.course_id <span class="operator">=</span> cs.id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> stu.id;	</span><br></pre></td></tr></table></figure>

<p><img src="/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/array.png"></p>
<h1 id="node操作数据库">3. node操作数据库</h1><h2 id="认识mysql2">3.1. 认识mysql2</h2><p><a target="_blank" rel="noopener" href="https://github.com/sidorares/node-mysql2">https://github.com/sidorares/node-mysql2</a></p>
<ul>
<li>如何在Node的代码中执行SQL语句来，这里可以借助于两个库: <ul>
<li>mysql：最早的Node连接MySQL的数据库驱动;</li>
<li>mysql2：在mysql的基础之上，进行了很多的优化、改进;</li>
</ul>
</li>
<li>目前相对来说，更偏向于使用mysql2，mysql2兼容mysql的API，并且提供了一些附加功能 <ul>
<li>更快&#x2F;更好的性能;</li>
<li>Prepared Statement(预编译语句):<ul>
<li>提高性能：将创建的语句模块发送给MySQL，然后MySQL编译(解析、优化、转换)语句模块，并且存储它，但是不执行，在真正执行时会提供实际的参数才会执行；就算多次执行，也只会编译一次，所以性能是更高的;</li>
<li>防止SQL注入：之后传入的值不会像模块引擎那样就编译，那么一些SQL注入的内容不会被执行；or 1 &#x3D; 1不会被执行;</li>
</ul>
</li>
<li>支持Promise，所以我们可以使用async和await语法</li>
<li>….</li>
</ul>
</li>
</ul>
<h2 id="使用mysql2">3.2. 使用mysql2</h2><ul>
<li><p>安装mysql2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mysql2</span><br></pre></td></tr></table></figure>
</li>
<li><p>mysql2的使用过程如下</p>
<ol>
<li>创建连接(通过createConnection)，并且获取连接对象; </li>
<li>执行SQL语句即可(通过query);</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&quot;mysql2&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 创建数据库连接</span></span><br><span class="line"><span class="keyword">const</span> connection = mysql.<span class="title function_">createConnection</span>(&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="attr">database</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">    <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;密码&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 执行sql语句</span></span><br><span class="line"><span class="keyword">const</span> statement = <span class="string">&#x27;select * from user&#x27;</span>;</span><br><span class="line">connection.<span class="title function_">query</span>(statement,<span class="function">(<span class="params">err,result,fields</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(fields);</span><br><span class="line">    <span class="comment">// 关闭数据库连接</span></span><br><span class="line">    connection.<span class="title function_">destroy</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Prepared-Statement">3.2.1. Prepared Statement</h3><ul>
<li><p>Prepared Statement(预编译语句)</p>
<ul>
<li>提高性能:将创建的语句模块发送给MySQL，然后MySQL编译(解析、优化、转换)语句模块，并且存储它，但是不执行，在真正执行时会提供实际的参数才会执行；就算多次执行，也只会编译一次，所以性能是更高的;</li>
<li>防止SQL注入：之后传入的值不会像模块引擎那样就编译，那么一些SQL注入的内容不会被执行；or 1 &#x3D; 1不会被执行;</li>
</ul>
</li>
<li><p>如果再次执行该语句，它将会从LRU(Least Recently Used) Cache中获取获取，省略了编译statement 的时间来提高性能</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&quot;mysql2&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 创建数据库连接</span></span><br><span class="line"><span class="keyword">const</span> connection = mysql.<span class="title function_">createConnection</span>(&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="attr">database</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">    <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;密码&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 执行sql语句</span></span><br><span class="line"><span class="comment">// Prepared Statement</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;select * from user where age &gt; ? and name like &quot;%a%&quot;&#x27;</span>;</span><br><span class="line">connection.<span class="title function_">execute</span>(sql,[<span class="number">18</span>],<span class="function">(<span class="params">err,result</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Connection-Pools">3.2.2. Connection Pools</h3><ul>
<li>如果有多个请求的话，该连接很有可能正在被占用，那么是否需要每次一个请求都去创建一个新的连接呢?<ul>
<li>事实上，mysql2给我们提供了连接池(connection pools);</li>
<li>连接池可以在需要的时候自动创建连接，并且创建的连接不会被销毁，会放到连接池中，后续可以继续使用; </li>
<li>在创建连接池的时候设置LIMIT，也就是最大创建个数;</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> connection = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="attr">database</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">    <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">    <span class="attr">connectionLimit</span>: <span class="number">5</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h3 id="Promise方式">3.2.3. Promise方式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&quot;mysql2&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 创建数据库连接</span></span><br><span class="line"><span class="keyword">const</span> connection = mysql.<span class="title function_">createConnection</span>(&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="attr">database</span>: <span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">    <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">    <span class="attr">connectionLimit</span>: <span class="number">5</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Prepared Statement</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;select * from user where age &gt; ? and name like &quot;%a%&quot;&#x27;</span>;</span><br><span class="line"><span class="comment">// promise</span></span><br><span class="line">connection.<span class="title function_">promise</span>().<span class="title function_">execute</span>(sql,[<span class="number">18</span>]).<span class="title function_">then</span>(<span class="function">(<span class="params">[results,fields]</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h2 id="认识ORM">3.3. 认识ORM</h2><ul>
<li><p>对象关系映射(英语:Object Relational Mapping，简称ORM，或O&#x2F;RM，或O&#x2F;R mapping)，是一种程序设计的方案:</p>
<ul>
<li>从效果上来讲，它提供了一个可在编程语言中，使用虚拟对象数据库 的效果; </li>
<li>比如在Java开发中经常使用的ORM包括：<code>Hibernate</code>、<code>MyBatis</code>;</li>
</ul>
</li>
<li><p>Node当中的ORM通常使用的是 <code>sequelize</code>;</p>
<ul>
<li>Sequelize是用于Postgres，MySQL，MariaDB，SQLite和Microsoft SQL Server的基于Node.js 的 ORM; </li>
<li>它支持非常多的功能;</li>
</ul>
</li>
<li><p>如果希望将Sequelize和MySQL一起使用，那么需要先安装两个东西: </p>
<ul>
<li><p>mysql2：sequelize在操作mysql时使用的是mysql2;</p>
</li>
<li><p>sequelize：使用它来让对象映射到表中;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install sequelize</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="Sequelize的使用">3.3.1. Sequelize的使用</h3><p><a target="_blank" rel="noopener" href="https://github.com/sequelize/sequelize/">https://github.com/sequelize/sequelize/</a></p>
<p><a target="_blank" rel="noopener" href="https://sequelize.org/docs/v6/getting-started/">https://sequelize.org/docs/v6/getting-started/</a></p>
<ol>
<li><p>创建一个Sequelize的对象，并且指定数据库、用户名、密码、数据库类型、主机地址等; </p>
</li>
<li><p>测试连接是否成功;</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;<span class="title class_">Sequelize</span>,<span class="title class_">DataTypes</span>&#125; = <span class="built_in">require</span>(<span class="string">&quot;sequelize&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *   constructor(database: string, username: string, password?: string, options?: Options);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> <span class="title class_">Sequelize</span>(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;密码&quot;</span>,&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">dialect</span>: <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">sequelize.<span class="title function_">authenticate</span>()</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sequelize连接成功&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sequelize连接失败&quot;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="Sequelize映射关系表">3.3.2. Sequelize映射关系表</h3><p><a target="_blank" rel="noopener" href="https://sequelize.org/docs/v6/core-concepts/model-basics/">https://sequelize.org/docs/v6/core-concepts/model-basics/</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;<span class="title class_">Sequelize</span>,<span class="title class_">DataTypes</span>,<span class="title class_">Model</span>,<span class="title class_">Op</span>&#125; = <span class="built_in">require</span>(<span class="string">&quot;sequelize&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *   constructor(database: string, username: string, password?: string, options?: Options);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> <span class="title class_">Sequelize</span>(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;密码&quot;</span>,&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">dialect</span>: <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Model</span>&#123;&#125;</span><br><span class="line"><span class="title class_">User</span>.<span class="title function_">init</span>(&#123;</span><br><span class="line">    <span class="attr">id</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">primaryKey</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">autoIncrement</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="title function_">STRING</span>(<span class="number">255</span>),</span><br><span class="line">        <span class="attr">allowNull</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">age</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">defaultValue</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">telPhone</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="title function_">STRING</span>(<span class="number">20</span>),</span><br><span class="line">        <span class="attr">allowNull</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">unique</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    <span class="attr">tableName</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">    sequelize,</span><br><span class="line">    <span class="attr">createdAt</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">updatedAt</span>: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询所有内容</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">queryAll</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findAll</span>(&#123;&#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">queryAll</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询指定内容</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">queryCondition</span>(<span class="params">age</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findAll</span>(&#123;</span><br><span class="line">        <span class="attr">where</span>: &#123;</span><br><span class="line">            <span class="attr">age</span>: &#123;</span><br><span class="line">                [<span class="title class_">Op</span>.<span class="property">gt</span>]: age</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 查询年龄 &gt; 20 </span></span><br><span class="line"><span class="title function_">queryCondition</span>(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// insert </span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">insertUser</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>: obj.<span class="property">name</span>,</span><br><span class="line">        <span class="attr">age</span>: obj.<span class="property">age</span>,</span><br><span class="line">        <span class="attr">telPhone</span>: obj.<span class="property">phone</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">insertUser</span>(&#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;abc&#x27;</span>,</span><br><span class="line">     <span class="attr">age</span>: <span class="number">17</span>,</span><br><span class="line">     <span class="attr">phone</span>: <span class="string">&#x27;11111111111&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">updateUser</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">update</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>: obj.<span class="property">name</span>,</span><br><span class="line">        <span class="attr">age</span>: obj.<span class="property">age</span>,</span><br><span class="line">        <span class="attr">telPhone</span>: obj.<span class="property">phone</span></span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        <span class="attr">where</span>: &#123;</span><br><span class="line">            <span class="attr">id</span>: obj.<span class="property">id</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">updateUser</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;abc&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="attr">phone</span>: <span class="string">&#x27;00000000000&#x27;</span>,</span><br><span class="line">    <span class="attr">id</span>: <span class="number">11</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h3 id="一对多操作">3.3.3. 一对多操作</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多表映射</span></span><br><span class="line"><span class="keyword">const</span> &#123;<span class="title class_">Sequelize</span>,<span class="title class_">Model</span>,<span class="title class_">DataTypes</span>,<span class="title class_">Op</span>&#125; = <span class="built_in">require</span>(<span class="string">&quot;sequelize&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> <span class="title class_">Sequelize</span>(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;密码&quot;</span>,&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">dialect</span>: <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 学生表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Brand</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Model</span>&#123;&#125;</span><br><span class="line"><span class="title class_">Brand</span>.<span class="title function_">init</span>(&#123;</span><br><span class="line">    <span class="attr">id</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">primaryKey</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">autoIncrement</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">STRING</span>,</span><br><span class="line">        <span class="attr">allowNull</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">website</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">STRING</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">worldRank</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    sequelize,</span><br><span class="line">    <span class="attr">tableName</span>: <span class="string">&#x27;brand&#x27;</span>,</span><br><span class="line">    <span class="attr">createdAt</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">updatedAt</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 课程表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Products</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Model</span>&#123;&#125;</span><br><span class="line"><span class="title class_">Products</span>.<span class="title function_">init</span>(&#123;</span><br><span class="line">    <span class="attr">id</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">primaryKey</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">autoIncrement</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">brand</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">STRING</span>,</span><br><span class="line">        <span class="attr">allowNull</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">brandId</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">references</span>: &#123;</span><br><span class="line">            <span class="attr">model</span>: <span class="title class_">Brand</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;id&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">field</span>: <span class="string">&#x27;brand_id&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    sequelize,</span><br><span class="line">    <span class="attr">tableName</span>: <span class="string">&#x27;products&#x27;</span>,</span><br><span class="line">    <span class="attr">createdAt</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">updatedAt</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 建立表关系</span></span><br><span class="line"><span class="title class_">Products</span>.<span class="title function_">belongsTo</span>(<span class="title class_">Brand</span>,&#123;</span><br><span class="line">    <span class="attr">foreignKey</span>: <span class="string">&#x27;brandId&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">queryAll</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">Products</span>.<span class="title function_">findAll</span>(&#123;</span><br><span class="line">        <span class="attr">include</span>: &#123;</span><br><span class="line">            <span class="attr">model</span>: <span class="title class_">Brand</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">queryAll</span>();</span><br></pre></td></tr></table></figure>

<p>转换的语句</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Executing (default): SELECT `Products`.`<span class="built_in">id</span>`, `Products`.`brand`, `Products`.`brand_id` AS `brandId`, `Brand`.`<span class="built_in">id</span>` AS `Brand.<span class="built_in">id</span>`, `Brand`.`name` AS `Brand.name`, `Brand`.`website` AS `Brand.website`, `Brand`.`worldRank` AS `Brand.worldRank` FROM `products` AS `Products` LEFT OUTER JOIN `brand` AS `Brand` ON `Products`.`brand_id` = `Brand`.`<span class="built_in">id</span>`;</span><br></pre></td></tr></table></figure>



<h3 id="多对多操作">3.3.4. 多对多操作</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多表映射</span></span><br><span class="line"><span class="keyword">const</span> &#123;<span class="title class_">Sequelize</span>,<span class="title class_">Model</span>,<span class="title class_">DataTypes</span>,<span class="title class_">Op</span>&#125; = <span class="built_in">require</span>(<span class="string">&quot;sequelize&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> <span class="title class_">Sequelize</span>(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;密码&quot;</span>,&#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="attr">dialect</span>: <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 学生表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Model</span>&#123;&#125;</span><br><span class="line"><span class="title class_">Student</span>.<span class="title function_">init</span>(&#123;</span><br><span class="line">    <span class="attr">id</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">primaryKey</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">autoIncrement</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">STRING</span>,</span><br><span class="line">        <span class="attr">allowNull</span>: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    sequelize,</span><br><span class="line">    <span class="attr">tableName</span>: <span class="string">&#x27;students&#x27;</span>,</span><br><span class="line">    <span class="attr">createdAt</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">updatedAt</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 课程表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Course</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Model</span>&#123;&#125;</span><br><span class="line"><span class="title class_">Course</span>.<span class="title function_">init</span>(&#123;</span><br><span class="line">    <span class="attr">id</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">primaryKey</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">autoIncrement</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">STRING</span>,</span><br><span class="line">        <span class="attr">allowNull</span>: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    sequelize,</span><br><span class="line">    <span class="attr">tableName</span>: <span class="string">&#x27;courses&#x27;</span>,</span><br><span class="line">    <span class="attr">createdAt</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">updatedAt</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 学生-课程表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StudentCourse</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Model</span>&#123;&#125;</span><br><span class="line"><span class="title class_">Student</span>.<span class="title function_">init</span>(&#123;</span><br><span class="line">    <span class="attr">id</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">primaryKey</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">autoIncrement</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">studentId</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">references</span>: &#123;</span><br><span class="line">            <span class="attr">model</span>: <span class="title class_">Student</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;id&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">field</span>: <span class="string">&#x27;student_id&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">courseId</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">        <span class="attr">references</span>: &#123;</span><br><span class="line">            <span class="attr">model</span>: <span class="title class_">Course</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;id&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">field</span>: <span class="string">&#x27;course_id&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    sequelize,</span><br><span class="line">    <span class="attr">tableName</span>: <span class="string">&#x27;students_select_courses&#x27;</span>,</span><br><span class="line">    <span class="attr">createdAt</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">updatedAt</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 建立表关系</span></span><br><span class="line"><span class="title class_">Student</span>.<span class="title function_">belongsToMany</span>(<span class="title class_">Course</span>,&#123;</span><br><span class="line">    <span class="attr">through</span>: <span class="string">&#x27;students_select_courses&#x27;</span>,</span><br><span class="line">    <span class="attr">foreignKey</span>: <span class="string">&#x27;student_id&#x27;</span>,</span><br><span class="line">    <span class="attr">otherKey</span>: <span class="string">&#x27;course_id&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="title class_">Course</span>.<span class="title function_">belongsToMany</span>(<span class="title class_">Student</span>,&#123;</span><br><span class="line">    <span class="attr">through</span>: <span class="string">&#x27;students_select_courses&#x27;</span>,</span><br><span class="line">    <span class="attr">foreignKey</span>: <span class="string">&#x27;course_id&#x27;</span>,</span><br><span class="line">    <span class="attr">otherKey</span>: <span class="string">&#x27;student_id&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">queryStudent</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">Student</span>.<span class="title function_">findAll</span>(&#123;</span><br><span class="line">        <span class="attr">include</span>: &#123;</span><br><span class="line">            <span class="attr">model</span>: <span class="title class_">Course</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">queryStudent</span>();</span><br></pre></td></tr></table></figure>

<p>转换的语句</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Executing (default): SELECT `Student`.`<span class="built_in">id</span>`, `Student`.`student_id` AS `studentId`, `Student`.`course_id` AS `courseId`, `Courses`.`<span class="built_in">id</span>` AS `Courses.<span class="built_in">id</span>`, `Courses`.`name` AS `Courses.name`, `Courses-&gt;students_select_courses`.`student_id` AS `Courses.students_select_courses.student_id`, `Courses-&gt;students_select_courses`.`course_id` AS `Courses.students_select_courses.course_id` FROM `students_select_courses` AS `Student` LEFT OUTER JOIN ( `students_select_courses` AS `Courses-&gt;students_select_courses` INNER JOIN `courses` AS `Courses` ON `Courses`.`<span class="built_in">id</span>` = `Courses-&gt;students_select_courses`.`course_id`) ON `Student`.`<span class="built_in">id</span>` = `Courses-&gt;students_select_courses`.`student_id`;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <div>      <div>
    
        <div style="margin-top:30px;padding-top:20px;border-top: 1px dashed #b3a9a7;text-align:center;color: #ccc;font-size:20px;">本文结束&nbsp;<i class="fa fa-paw"></i>&nbsp;感谢您的阅读</div>
    
</div>  </div>
        

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Wang Ting
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <!-- <a href="https://wtlumos.github.io/zh-CN/2020/06/05/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B009-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/" title="nodejs学习笔记09-MySQL数据库">https://wtlumos.github.io/zh-CN/2020/06/05/nodejs学习笔记09-MySQL数据库/</a> -->
    
       <a href ="/zh-CN/2020/06/05/nodejs学习笔记09-MySQL数据库/" >/zh-CN/2020/06/05/nodejs学习笔记09-MySQL数据库/</a>
  </li>
       <li>
          <strong>发布时间：</strong>
          2020-06-05 23:34
      </li>
      <li>
          <strong>更新时间：</strong>
          2023-04-15 16:18

      </li>
  
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/js/" rel="tag"><i class="fa fa-tag"></i> js</a>
              <a href="/tags/nodejs/" rel="tag"><i class="fa fa-tag"></i> nodejs</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/zh-CN/2020/06/07/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B010-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" rel="prev" title="nodejs学习笔记10-项目实战">
      <i class="fa fa-chevron-left"></i> nodejs学习笔记10-项目实战
    </a></div>
      <div class="post-nav-item">
    <a href="/zh-CN/2020/06/03/nodejs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B008-web%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="next" title="nodejs学习笔记08-web服务器">
      nodejs学习笔记08-web服务器 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5"><span class="nav-text">1. 基础认知</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">1.1. 为什么需要数据库?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%89%E5%93%AA%E4%BA%9B"><span class="nav-text">1.2. 常见的数据库有哪些?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A4%E8%AF%86MySQL"><span class="nav-text">1.3. 认识MySQL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%84%E7%BB%87%E6%96%B9%E5%BC%8F"><span class="nav-text">1.4. 数据组织方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BDMySQL%E8%BD%AF%E4%BB%B6"><span class="nav-text">1.5. 下载MySQL软件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%88%E7%AB%AF%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">1.6. 终端操作数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">1.6.1. 连接数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">1.6.2. 显示数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93-%E8%A1%A8"><span class="nav-text">1.6.3. 创建数据库-表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GUI%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="nav-text">1.7. GUI工具的介绍</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL%E8%AF%AD%E5%8F%A5"><span class="nav-text">2. SQL语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A4%E8%AF%86SQL"><span class="nav-text">2.1. 认识SQL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-text">2.2. SQL语句的分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DDL-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-text">2.3. DDL - 数据库的操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-text">2.4. SQL的数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B"><span class="nav-text">2.4.1. 数字类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B"><span class="nav-text">2.4.2. 日期类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="nav-text">2.4.3. 字符串类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E7%BA%A6%E6%9D%9F"><span class="nav-text">2.5. 表约束</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E9%94%AE-PRIMARY-KEY"><span class="nav-text">2.5.1. 主键:PRIMARY KEY</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%94%AF%E4%B8%80-UNIQUE"><span class="nav-text">2.5.2. 唯一:UNIQUE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E8%83%BD%E4%B8%BA%E7%A9%BA-NOT-NULL"><span class="nav-text">2.5.3. 不能为空:NOT NULL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E5%80%BC-DEFAULT"><span class="nav-text">2.5.4. 默认值:DEFAULT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E9%80%92%E5%A2%9E-AUTO-INCREMENT"><span class="nav-text">2.5.5. 自动递增:AUTO_INCREMENT</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DML-%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-text">2.6. DML-数据表的操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DQL-%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="nav-text">2.7. DQL-数据表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.7.1. 基本查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.7.2. 条件查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.7.3. 模糊查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E6%8E%92%E5%BA%8F"><span class="nav-text">2.7.4. 查询结果排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.7.5. 分页查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="nav-text">2.7.6. 聚合函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Group-By"><span class="nav-text">2.7.7. Group By</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%A4%9A%E5%BC%A0%E8%A1%A8"><span class="nav-text">2.8. 创建多张表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BB%BA%E8%A1%A8"><span class="nav-text">2.8.1. 建表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%A4%96%E9%94%AE"><span class="nav-text">2.8.2. 创建外键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E9%94%AE%E5%AD%98%E5%9C%A8%E6%97%B6%E6%9B%B4%E6%96%B0%E5%92%8C%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-text">2.8.3. 外键存在时更新和删除数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E6%9B%B4%E6%96%B0%E5%91%A2"><span class="nav-text">2.8.4. 如何进行更新呢?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.8.5. 多表查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A6%E8%BF%9E%E6%8E%A5"><span class="nav-text">2.8.6. 左连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%B3%E8%BF%9E%E6%8E%A5"><span class="nav-text">2.8.7. 右连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="nav-text">2.8.8. 内连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E8%BF%9E%E6%8E%A5"><span class="nav-text">2.8.9. 全连接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE"><span class="nav-text">2.9. 多对多关系数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BB%BA%E7%AB%8B%E4%B8%A4%E5%BC%A0%E8%A1%A8"><span class="nav-text">2.9.1. 建立两张表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%85%B3%E7%B3%BB%E8%A1%A8"><span class="nav-text">2.9.2. 创建关系表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E5%A4%9A%E5%AF%B9%E5%A4%9A%E6%95%B0%E6%8D%AE"><span class="nav-text">2.9.3. 查询多对多数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%86%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E5%88%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%88%90%E5%AF%B9%E8%B1%A1"><span class="nav-text">2.10. 将联合查询到的数据转成对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%86%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E5%88%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%88%90%E6%95%B0%E7%BB%84"><span class="nav-text">2.11. 将联合查询到的数据转成数组</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#node%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">3. node操作数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A4%E8%AF%86mysql2"><span class="nav-text">3.1. 认识mysql2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8mysql2"><span class="nav-text">3.2. 使用mysql2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Prepared-Statement"><span class="nav-text">3.2.1. Prepared Statement</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Connection-Pools"><span class="nav-text">3.2.2. Connection Pools</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise%E6%96%B9%E5%BC%8F"><span class="nav-text">3.2.3. Promise方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A4%E8%AF%86ORM"><span class="nav-text">3.3. 认识ORM</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Sequelize%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">3.3.1. Sequelize的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sequelize%E6%98%A0%E5%B0%84%E5%85%B3%E7%B3%BB%E8%A1%A8"><span class="nav-text">3.3.2. Sequelize映射关系表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E5%AF%B9%E5%A4%9A%E6%93%8D%E4%BD%9C"><span class="nav-text">3.3.3. 一对多操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%AF%B9%E5%A4%9A%E6%93%8D%E4%BD%9C"><span class="nav-text">3.3.4. 多对多操作</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wang Ting"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Wang Ting</p>
  <div class="site-description" itemprop="description">技术成长笔记</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">381</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">46</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/WTlumos" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;WTlumos" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/7807823198" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7807823198" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-glasses fa-fw"></i>
      最近阅读
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.bilibili.com/video/av77638697/" title="https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;av77638697&#x2F;" rel="noopener" target="_blank">浙江大学-研究生机器学习课程</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wang Ting</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span>网站总字数: </span>
    <span title="站点总字数">2.9m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
        <span>阅读总时长: </span>
    <span title="站点阅读时长">44:22</span>
</div>

<span id="sitetime"></span>

<script language=javascript>
  function siteTime(){
    window.setTimeout("siteTime()", 1000);
    var seconds = 1000;
    var minutes = seconds * 60;
    var hours = minutes * 60;
    var days = hours * 24;
    var years = days * 365;
    var today = new Date();
    var todayYear = today.getFullYear();
    var todayMonth = today.getMonth()+1;
    var todayDate = today.getDate();
    var todayHour = today.getHours();
    var todayMinute = today.getMinutes();
    var todaySecond = today.getSeconds();
    /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
    year - 作为date对象的年份，为4位年份值
    month - 0-11之间的整数，做为date对象的月份
    day - 1-31之间的整数，做为date对象的天数
    hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
    minutes - 0-59之间的整数，做为date对象的分钟数
    seconds - 0-59之间的整数，做为date对象的秒数
    microseconds - 0-999之间的整数，做为date对象的毫秒数 */
    var t1 = Date.UTC(2018,07,01,00,00,00); //北京时间2018-07-01 00:00:00
    var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
    var diff = t2-t1;
    var diffYears = Math.floor(diff/years);
    var diffDays = Math.floor((diff/days)-diffYears*365);
    var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
    var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
    var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);

    if(window.location.pathname=='/en/'){
           document.getElementById("sitetime").innerHTML=" Run for "+ diffYears+" Year "+ diffDays+" Days "+diffHours+" Hours "+diffMinutes+" Minute "+diffSeconds+" Second";
    }else{
          document.getElementById("sitetime").innerHTML=" 已运行 "+ diffYears+" 年 "+ diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
    }

  }
  siteTime();
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'fb5f16fdf7649a9e5208',
      clientSecret: 'bcd95c87cdbab8fa32fc1b006fbb1ce7e8ffae5b',
      repo        : 'wtlumos.github.io',
      owner       : 'WTlumos',
      admin       : ['WTlumos'],
      id          : 'b1cc4d2d0d9dc94b02b71f702630a25f',
        language: '',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":125,"height":290,"hOffset":-15,"vOffset":-40},"mobile":{"show":true,"scale":0.5},"react":{"opacity":0.7},"dialog":{"enable":false,"hitokoto":false},"log":false});</script></body>
</html>
